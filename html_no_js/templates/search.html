{% extends 'base.html' %}
{% block title %}Search results — Fast Todo (no-js){% endblock %}
{% block content %}
  <h2>Search results for "{{ q }}"</h2>
  <form method="get" action="/html_no_js/search" style="margin-bottom:0.75rem">
    <input type="text" name="q" value="{{ q }}" placeholder="Search" style="min-width:16rem">
    <label style="margin-left:0.5rem"><input type="checkbox" name="include_list_todos" value="1" {% if include_list_todos %}checked{% endif %}> include todos from matching lists</label>
  <label style="margin-left:0.5rem"><input type="checkbox" name="exclude_completed" value="1" {% if exclude_completed %}checked{% endif %}> exclude completed</label>
    <button type="submit" style="margin-left:0.5rem">Search</button>
  </form>
  {% if results.lists and results.lists|length > 0 %}
    <h3>Matching lists</h3>
    <ul class="lists-list">
      {% for l in results.lists %}
        <li class="list-item">
          <div class="list-main">
            <a class="list-title {% if l.completed %}done{% endif %}" href="/html_no_js/lists/{{ l.id }}">{{ l.name }}</a>
      {% if l.tags and l.tags|length > 0 %}
              <div class="tags meta">
        {% for tag in (l.tags | sort) %}
                  <a class="tag-chip" href="/html_no_js/search?q={{ tag|urlencode }}">{{ tag }}</a>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if results.todos and results.todos|length > 0 %}
    <h3>Matching todos</h3>
    <ul class="todos-list">
      {% for t in results.todos %}
        <li class="todo">
          <span class="pin-icon">�</span>
          <div class="todo-content">
            <div class="todo-main">
              <div class="{% if t.completed %}done{% endif %}"><a href="/html_no_js/todos/{{ t.id }}">{{ t.text }}</a></div>
        {% if t.tags and t.tags|length > 0 %}
                <div class="tags meta">
          {% for tag in (t.tags | sort) %}
                    <a class="tag-chip" href="/html_no_js/search?q={{ tag|urlencode }}">{{ tag }}</a>
                  {% endfor %}
                </div>
              {% endif %}
              {% if t.note %}
                <div class="meta note-text">{{ t.note }}</div>
                <div class="meta">in <a href="/html_no_js/lists/{{ t.list_id }}">{{ t.list_name or t.list_id }}</a></div>
              {% endif %}
            </div>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% endif %}

  <p><a href="/html_no_js/">Back to lists</a></p>
{% endblock %}
